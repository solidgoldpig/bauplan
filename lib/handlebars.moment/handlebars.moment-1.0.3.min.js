!function(a){"object"==typeof exports?module.exports=a(require("lodash"),require("moment")):"function"==typeof define&&define.amd&&define(["lodash","moment"],a)}(function(a,e){var t=function(t){var s={isoweekday:"isoWeekday",dayofyear:"dayOfYear",isoweek:"isoWeek",isoweeks:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear",zoneabbr:"zoneAbbr",zonename:"zoneName",tostring:"toString",string:"toString",str:"toString",valueof:"valueOf",value:"valueOf",val:"valueOf",fromnow:"fromNow",daysinmonth:"daysInMonth",todate:"toDate",toarray:"toArray",array:"toArray",tojson:"toJSON",json:"toJSON",toisostring:"toISOString",isostring:"toISOString"},o={L:"dddd",S:"ddd",XS:"dd"};t.registerHelper("moment",function(){function t(a,e){return"string"==typeof a&&a.match(/^\d+(\.\d+){0,1}$/)&&(a=+a),e&&"number"==typeof a&&(a=1e3*a),a}function r(a){var e=p[a];if(e){var t=p[a+"param"];void 0===t&&(t=p.amount);var s=e;if(t){var o=+e;s={},isNaN(o)?s[e]=+t:s[t]=o}g[a](s)}}var i=Array.prototype.slice.call(arguments),n=i.pop(),f=i.shift(),d=i.shift(),u=i.shift(),m=i.shift(),h=i.shift();n.hash&&n.hash.params&&(n.hash=a.extend({},n.hash.params,n.hash),delete n.hash.params);var p=n.hash;f||(f=p.date),f=t(f,p.unix);var l=t(p.max,p.unixmax),v=t(p.min,p.unixmin);d||(d=p.format||p.fn),s[d]&&(d=s[d]),"weekday"===d&&(p.type=p.type?p.type.toUpperCase():null,"NUMBER"!==p.type&&(d=o[p.type]?o[p.type]:o.L));var y="start",c=p.startOf||p.startof;c||(c=p.endOf||p.endof,c&&(y="end"));var g;if(e.isMoment(f))g=f.clone();else{var x=p.utc?e.utc:e;g=x(f,p.input)}p.lang&&g.lang(p.lang),l&&(g=g.max(l)),v&&(g=g.min(v)),c&&(g=g[y+"Of"](c)),void 0===p.nosuffix&&void 0!==p.suffix&&(p.nosuffix=!p.suffix),p.from&&(d="from",u=t(p.from,p.unixfrom)),"fromNow"===d&&void 0===u&&(u=p.nosuffix),"from"===d&&void 0===m&&(m=p.nosuffix),p.diff&&(d="diff",u=t(p.diff,p.unixdiff)),"diff"===d&&(void 0===m&&(m=p.unitdiff),void 0===h&&(h=p.nosuffix)),r("add"),r("subtract"),p.local?g.local():p.utc&&g.utc();var k=g[d]?g[d](u,m,h):g.format(d);return k});var r={asmilliseconds:"asMilliseconds",asseconds:"asSeconds",asminutes:"asMinutes",ashours:"asHours",asdays:"asDays",asweeks:"asWeeks",asmonths:"asMonths",asyears:"asYears"},i=["ms","s","m","h","d","w","M","y"],n={};for(var f in i)n[i[f]]=!0;t.registerHelper("duration",function(){function t(a){var e=u[a];if(e){isNaN(+e)||(e=+e);var t=u[a+"unit"];void 0===t&&(t=u[a+"param"]),m[a](e,t)}}var s=Array.prototype.slice.call(arguments),o=s.pop(),i=s.shift(),f=s.shift(),d=s.shift();o.hash&&o.hash.params&&(o.hash=a.extend({},o.hash.params,o.hash),delete o.hash.params);var u=o.hash;i||(i=u.duration),"string"==typeof i&&i.match(/^\d+$/)&&(i=+i);var m=e.duration(i,u.input);return t("add"),t("subtract"),f||(f=u.method),n[f]&&(d=f,f="get"),r[f]&&(f=r[f]),u.as?(f="as",d=u.as):u.get&&(f="get",d=u.get),m[f]||(f="humanize"),"humanize"===f&&void 0===d&&(d=u.suffix),m[f](d)})},s={registerHelpers:function(a){t(a)}};return s});