!function(){function e(){var e=this._constructorArg,i=this;this._referenceCount=0,this._objectOptionsByCid={},this._boundDataObjectsByCid={},_.each(ht,function(e){i[e.name]=[]}),at[this.cid]=this,this.children={},this._renderCount=0,_.extend(this,e||{}),t.call(this),_.each(ht,function(e){e.configure&&e.configure.call(this)},this),this.trigger("configure")}function t(){this.helpers&&_.each(this.helpers,function(e,t){var i=this;this.helpers[t]=function(){var t=_.toArray(arguments),n=_.last(t);return n.context=this,e.apply(i,t)}},this)}function i(e){return'Error "'+e+'". For more information visit http://thoraxjs.org/error-codes.html#'+e}function n(e,t){var i=e.extend;e.extend=function(){var e=i.apply(this,arguments);return e.prototype.name&&(t[e.prototype.name]=e),e}}function r(e,t,i,n){var r,o=e[t];if(_.indexOf(i,".")>=0){var s=i.split(/\./);i=s.pop(),_.each(s,function(e){o=o[e]})}if(o&&(r=o[i]),r||n)return r;throw new Error(t+": "+i+" does not exist.")}function o(e,t){var i;if(_.isString(this[e])?i=lt.Util.getViewClass(this[e],!0):this.name&&!_.isFunction(this[e])&&(i=lt.Util.getViewClass(this.name+(t.extension||""),!0)),i&&!_.isFunction(this[e])&&(this[e]=i),t.required&&!_.isFunction(this[e]))throw new Error("View "+(this.name||this.cid)+" requires: "+e)}function s(e,t){var i;if(_.isString(this[e])?i=lt.Util.getTemplate(this[e],!0):this.name&&!_.isFunction(this[e])&&(i=lt.Util.getTemplate(this.name+(t.extension||""),!0)),!i&&"template"===e&&this._defaultTemplate&&(i=this._defaultTemplate),i&&!_.isFunction(this[e])&&(this[e]=i),t.required&&!_.isFunction(this[e])){var n=new Error("view-requires: "+e);throw n.info={name:this.name||this.cid,parent:this.parent&&(this.parent.name||this.parent.cid),helperName:this._helperName},n}}function a(e,t,i){return e&&e[t]?_.isFunction(e[t])?e[t].call(i||e):e[t]:null}function l(e){_.each(ht,function(t){e[t.name]||(e[t.name]=[])})}function c(e){_.each(ht,function(t){e[t.name]=[]})}function h(e,t,i,n){var r=[];_.has(e,t)&&r.push(e);var o=e;if(i)for(;o=o.__parent__;)_.has(o,t)&&r.push(o);else for(o=o.constructor;o;)o.prototype&&_.has(o.prototype,t)&&r.push(o.prototype),o=o.__super__&&o.__super__.constructor;for(var s=r.length;s--;)_.each(a(r[s],t,e),n)}function u(e,t,i,n){if(_.isObject(i)){var r=ht[t];if(r&&r.event)return e&&e.listenTo&&e[t]&&e[t].cid?p(e,i,n,t):p(e["_"+t+"Events"],i,n),!0}}function d(e,t,i,n,r){function o(){if(e.el)s.apply(r,arguments);else{if(a)throw new Error("destroyed-event:"+e.name+":"+i);a++}}var s=O(n,e),a=0;o._callback=s._callback||s,o._thoraxBind=!0,e.listenTo(t,i,o)}function p(e,t,i,n){function r(t,r){n?d(e,e[n],r,t,i||e):e.push([r,t,i])}_.each(t,function(e,t){_.isArray(e)?_.each(e,function(e){r(e,t)}):r(e,t)})}function f(e){if(!e||!e.data)throw new Error(i("handlebars-no-data"));return e.data}function m(e){e.tag&&(e.tagName=e.tag,delete e.tag),e["class"]&&(e.className=e["class"],delete e["class"])}function g(e){if(!ct){var t="area,base,br,col,embed,hr,img,input,keygen,link,menuitem,meta,param,source,track,wbr";ct={},_.each(t.split(","),function(e){ct[e]=!0})}return ct[e]}function v(e){ft.push.apply(ft,e),dt=new RegExp("^(nested\\s+)?("+ft.join("|")+")(?:\\s|$)")}function y(e,t){return function(i){var n=$(i.target).view({helper:!1});return n&&n.cid===t?(i.originalContext=this,e(i)):void 0}}function w(e,t){e+=t.originalName;var i=t.handler,n=_.isFunction(i)?i:this[i];if(!n)throw new Error('Event "'+i+'" does not exist '+(this.name||this.cid)+":"+e);var r=t.context||this,o=lt.bindSection("thorax-event",{view:r.name||r.cid,eventName:e},_.bind(n,r));return o._callback=n,o._thoraxBind=!0,o}function b(e,t,i){var n={originalName:e,handler:_.isString(t)?this[t]:t};if(e.match(dt)){var r=pt.exec(e);n.nested=!!r[1],n.name=r[2],n.type="DOM",n.selector=r[3]}else n.name=e,n.type="view";return n.context=i,n}function C(e){for(;e._helperName&&"view"!==e._helperName;)e=e.parent;return e}function x(e){var t=_.pick(e,"fn","inverse","hash","data");return t.data=_.omit(e.data,"cid","view","yield"),t}function V(e,t){function i(e,t){return _.every(e,function(e,i){return t[i]===e})}return e._helperName!==t._helperName?!1:(e=e._helperOptions,t=t._helperOptions,e.args.length===t.args.length&&i(e.args,t.args)&&_.isEqual(_.keys(e.options),_.keys(t.options))&&_.every(e.options,function(n,r){if("data"===r||"hash"===r)return i(e.options[r],t.options[r]);if("fn"===r||"inverse"===r){if(t.options[r]===n)return!0;var o=t.options[r]||{};return n&&_.has(n,"program")&&!n.depth&&o.program===n.program}return t.options[r]===n}))}function T(e,t){function i(i,n){var r=this[e],o=a(this,t.$el);return i===r?this:(r&&this.unbindDataObject(r),i?(this[e]=i,t.loading&&t.loading.call(this),this.bindDataObject(e,i,_.extend({},this.options,n)),o&&o.attr(t.cidAttrName,i.cid),i.trigger("set",i,r)):(this[e]=!1,t.change&&t.change.call(this,!1),o&&o.removeAttr(t.cidAttrName)),this.trigger("change:data-object",e,i,r),this)}t=ht[e]=_.defaults({name:"_"+e+"Events",event:!0},t),t.ctor=function(){if(this[e]){var i=this[e];this[e]=null,this[t.set](i)}},lt.View.prototype[t.set]=i}function H(e,t,i){var n=this;h(i,"_"+e+"Events",!0,function(e){d(n,t,e[0],e[1],e[2]||n)})}function E(e,t){e.load?e.load(function(){t&&t.success&&t.success(e)},t):e.fetch(t)}function O(e,t){return _.isFunction(e)?e:t[e]}function k(e,t){if(!t||!t.serializing){var i=this.getObjectOptions(e)||{};this.conditionalRender(i.render)}}function F(e){var t=this.getObjectOptions(e)||void 0;this.shouldRender(t&&t.render)&&this.renderCollection&&this.renderCollection()}function L(e){var t=this.getObjectOptions(e)||void 0;this.shouldRender(t&&t.render)&&this.ensureRendered()}function j(){this.itemFilter&&this.collection.forEach(N,this)}function N(e){var t=this.getCollectionElement();this.itemFilter&&t.find("["+vt+'="'+e.cid+'"]')[S.call(this,e)?"show":"hide"]()}function S(e){return this.itemFilter.call(this,e,this.collection.indexOf(e))}function D(){var e=this.getCollectionElement();this.emptyClass&&e.removeClass(this.emptyClass),e.removeAttr(xt),e.empty()}function B(){var e=this.getCollectionElement();this.emptyClass&&e.addClass(this.emptyClass),e.attr(xt,!0),this.appendEmpty()}function U(e,t){return _.each(e,function(i,n){return _.isObject(i)?U(i,t):void(t(i,n,e)===!1&&delete e[n])}),e}function M(){R.call(this),this.model&&this.model.previousAttributes&&this.model.set(this.model.previousAttributes(),{silent:!0})}function I(e,t,i){var n=0;$("select,input,textarea",t.root||e.el).each(function(){(t.children||e===$(this).view({helper:!1}))&&"button"!==this.type&&"cancel"!==this.type&&"submit"!==this.type&&this.name&&(i(this,n),++n)})}function A(e,t,i,n){for(var r,o=e,s=t.split("["),a=i.mode,l=0;l<s.length-1;++l){if(r=s[l].replace("]",""),!o[r]){if("serialize"!==a)return n(void 0,r);o[r]={}}o=o[r]}r=s[s.length-1].replace("]",""),n(o,r)}function R(){this.$("form").removeAttr("data-submit-wait")}function q(e){var t=e.getObjectOptions(e.model)||{};return t.populate===!0?{}:t.populate}function P(e,t){t=t||{},t.target=this,this.trigger(e,t),_.each(this.children,function(i){i.trigger(e,t)})}function Q(){++this._renderCount,this.$el.attr(Et,this.cid)}function z(){if(!this.$("["+Et+'="'+this.cid+'"]')[0])throw new Error("No layout element found in "+(this.name||this.cid))}function W(){return this.$("["+Et+'="'+this.cid+'"]')[0]||this.el[0]||this.el}function G(e){return function(){var t=_.toArray(arguments);t.unshift(e),this.parent.trigger.apply(this.parent,t)}}function J(e){var t=C(this);if(!this[e]){var i=t[e];i&&(this[e]=i)}}function K(e){var t=$(this),i=t.view({helper:!1}),n=t.attr(kt),r=t.attr($t),o=!1;n&&(o=i[n].call(i,e)),r&&i.trigger(r,e),"A"===this.tagName&&o===!1&&e.preventDefault()}function X(){Y(),Ft=lt._fastClickEventName||"click",$(document).on(Ft,Lt,K)}function Y(){Ft&&$(document).off(Ft,Lt,K)}function Z(e,t){function i(){r!==Backbone.history.getFragment()&&(o=!0,s.cancel(),t&&t())}function n(){Backbone.history.off("route",i),o||e.apply(this,arguments)}var r=Backbone.history.getFragment(),o=!1;Backbone.history.on("route",i);var s=_.bind(n,this);return s.cancel=function(){Backbone.history.off("route",i)},s}function et(e,t,i){if(this.isPopulated())return _.defer(e,this);2===arguments.length&&!_.isFunction(t)&&_.isObject(t)&&(i=t,t=!1);var n=this,r=!1,o=Z(_.bind(e,n),function(){r=!0,n._request&&(n._aborted=!0,n._request.abort()),t&&t.call(n,!1)});this.fetch(_.defaults({success:o,error:function(){o.cancel(),!r&&t&&t.apply(n,[!0].concat(_.toArray(arguments)))}},i))}function tt(e,t){if(e.resetQueue)this.fetchQueue=void 0;else if(this.fetchQueue){var n=(this.fetchQueue[0]||{}).reset;if(n!==e.reset)throw new Error(i("mixed-fetch"))}if(this.fetchQueue)return this.fetchQueue.push(e),this.fetchQueue._promise;if(this.fetchQueue=[e],e=_.defaults({success:it(this,this.fetchQueue,"success"),error:it(this,this.fetchQueue,"error"),complete:it(this,this.fetchQueue,"complete")},e),t){var r=t.call(this,e);return this.fetchQueue&&(this.fetchQueue._promise=r),r}return e}function it(e,t,i){return function(){var n=arguments;_.each(t,function(e){e[i]&&e[i].apply(this,n)},this),e.fetchQueue===t&&(e.fetchQueue=void 0)}}function nt(){this.render()}$.fn.forEach||($.fn.forEach=function(e,t){$.fn.each.call(this,function(i){e.call(t||this,this,i)})});var rt="data-view-name",ot="data-view-cid",st="data-view-helper",at={};Handlebars.templates||(Handlebars.templates={});var lt=this.Thorax={templatePathPrefix:"",Views:{},bindSection:function(e,t,i){return i||(i=t,t=void 0),function(){try{return i.apply(this,arguments)}catch(n){lt.onException(e,n,t)}}},runSection:function(e,t,i){return lt.bindSection(e,t,i)()},onException:function(e,t){throw t},templates:Handlebars.templates};lt.View=Backbone.View.extend({constructor:function(){this._constructorArg=arguments[0];var e=Backbone.View.apply(this,arguments);return delete this._constructorArg,_.each(ht,function(t){t.ctor&&t.ctor.call(this,e)},this),e},_configure:function(){},_ensureElement:function(){return e.call(this),Backbone.View.prototype._ensureElement.call(this)},toString:function(){return"[object View."+this.name+"]"},setElement:function(){var e=Backbone.View.prototype.setElement.apply(this,arguments);return this.name&&this.$el.attr(rt,this.name),this.$el.attr(ot,this.cid),e},_addChild:function(e){return this.children[e.cid]?e:(e.retain(),this.children[e.cid]=e,e.parent&&e.parent!==this&&!e._helperOptions&&e.parent._removeChild(e),e.parent=this,this.trigger("child",e),e)},_removeChild:function(e){return delete this.children[e.cid],e.parent=null,e.release(),e},_destroy:function(){_.each(this._boundDataObjectsByCid,this.unbindDataObject,this),this.trigger("destroyed"),delete at[this.cid],_.each(this.children,function(e){this._removeChild(e)},this),this.el&&(this.undelegateEvents(),this.remove(),this.off()),this.el=this.$el=void 0,this.parent=void 0,this.model=this.collection=this._collection=void 0,this._helperOptions=void 0},render:function(e){var t=this;if(t.el)return lt.runSection("thorax-render",{name:t.name},function(){if(t._rendering)throw new Error(i("nested-render"));t._previousHelpers=_.filter(t.children,function(e){return e._helperOptions});var n={};_.each(t.children,function(e,t){e._helperOptions||(n[t]=e)}),t.children=n,t.trigger("before:rendered"),t._rendering=!0;try{!_.isUndefined(e)&&(_.isElement(e)||lt.Util.is$(e)||e&&e.el||_.isString(e)||_.isFunction(e))?_.isFunction(e)&&(e=t.renderTemplate(e)):(s.call(t,"template",{required:!0}),e=t.renderTemplate(t.template)),_.each(t._previousHelpers,function(e){t._removeChild(e)},t),t._previousHelpers=void 0,t.html(e&&e.el||e&&e.string||e),++t._renderCount,t.trigger("rendered")}finally{t._rendering=!1}}),e},context:function(){return _.extend({},this.model&&this.model.attributes||{})},_getContext:function(){return _.extend({},this,a(this,"context")||{})},_getData:function(e){return{view:this,cid:_.uniqueId("t"),"yield":function(){return e.fn&&e.fn(e)}}},renderTemplate:function(e,t,i){var n;return t=t||this._getContext(),n=_.isFunction(e)?e:lt.Util.getTemplate(e,i),n?n(t,{helpers:this.helpers,data:this._getData(t)}):""},ensureRendered:function(){!this._renderCount&&this.render()},shouldRender:function(e){return e||null==e&&this._renderCount},conditionalRender:function(e){this.shouldRender(e)&&this.render()},appendTo:function(e){this.ensureRendered(),$(e).append(this.el),this.trigger("ready",{target:this})},html:function(e){if(_.isUndefined(e))return this.el.innerHTML;this.trigger("before:append");var t=this._replaceHTML(e);return this.trigger("append"),t},release:function(){--this._referenceCount,this._referenceCount<=0&&this._destroy()},retain:function(e){++this._referenceCount,e&&this.listenTo(e,"destroyed",e.release)},_replaceHTML:function(e){return this.el.innerHTML="",this.$el.append(e)},_anchorClick:function(e){var t=$(e.currentTarget),i=t.attr("href");return i&&("#"===i[0]||"/"===i[0]&&"/"!==i[1])?(Backbone.history.navigate(i,{trigger:!0}),!1):!0}}),lt.View.extend=function(){l(this);var e=Backbone.View.extend.apply(this,arguments);return e.__parent__=this,c(e),e},n(lt.View,lt.Views),$.fn.view=function(e){e=_.defaults(e||{},{helper:!0});var t="["+ot+"]";e.helper||(t+=":not(["+st+"])");var i=$(this).closest(t);return i&&at[i.attr(ot)]||!1};var ct,ht={};lt.Util={getViewInstance:function(e,t){var i=lt.Util.getViewClass(e,!0);return i?new i(t||{}):e},getViewClass:function(e,t){return _.isString(e)?r(lt,"Views",e,t):_.isFunction(e)?e:!1},getTemplate:function(e,t){var i,n=lt.templatePathPrefix;if(n&&e.substr(0,n.length)!==n&&(e=n+e),e=e.replace(/\.handlebars$/,""),i=Handlebars.templates[e],i||(e+=".handlebars",i=Handlebars.templates[e]),!i&&!t)throw new Error("templates: "+e+" does not exist.");return i},is$:function(e){return _.isObject(e)&&"length"in e},expandToken:function(e,t,i){function n(e,t){if(e.match(/^("|')/)&&e.match(/("|')$/))return e.replace(/(^("|')|('|")$)/g,"");for(var n=e.split("."),r=n.length,o=0;t&&r>o;o++)"this"!==n[o]&&(t=t[n[o]]);return i&&_.isString(t)?encodeURIComponent(t):t}if(e&&e.indexOf&&e.indexOf("{{")>=0){for(var r,o=/(?:\{?[^{]+)|(?:\{\{([^}]+)\}\})/g,s=[];r=o.exec(e);)if(r[1]){var a=r[1].split(/\s+/);if(a.length>1){var l=a.shift();a=_.map(a,function(e){return n(e,t)}),s.push(Handlebars.helpers[l]?Handlebars.helpers[l].apply(t,a):r[0])}else s.push(n(a[0],t))}else s.push(r[0]);e=s.join("")}return e},tag:function(e,t,n){var r=_.omit(e,"tagName"),o=e.tagName||"div",s=g(o);if(s&&t)throw new Error(i("void-tag-content"));var a="<"+o+" "+_.map(r,function(e,t){if(_.isUndefined(e)||"expand-tokens"===t)return"";var i=e;return n&&(i=lt.Util.expandToken(e,n)),("className"===t?"class":t)+'="'+Handlebars.Utils.escapeExpression(i)+'"'}).join(" ")+">";return s?a:a+(_.isUndefined(t)?"":t)+"</"+o+">"}},lt.Mixins={},_.extend(lt.View,{mixin:function(e){lt.Mixins[e](this)},registerMixin:function(e,t,i){lt.Mixins[e]=function(e){var n=!!e.cid;i&&_.extend(n?e:e.prototype,i),n?t.call(e):e.on("configure",t)}}}),lt.View.prototype.mixin=function(e){lt.Mixins[e](this)};var ut=lt.View.prototype.on;ht.event={name:"_events",configure:function(){var e=this;h(this.constructor,"_events",!0,function(t){e.on.apply(e,t)}),h(this,"events",!1,function(t,i){e.on(i,t,e)})}},_.extend(lt.View,{on:function(e,t){return l(this),u(this,e,t)?this:(_.isObject(e)?_.each(e,function(e,t){this.on(t,e)},this):_.isArray(t)?_.each(t,function(t){this._events.push([e,t])},this):this._events.push([e,t]),this)}}),_.extend(lt.View.prototype,{on:function(e,t,i){return u(this,e,t,i)?this:(_.isObject(e)&&arguments.length<3?_.each(e,function(e,i){this.on(i,e,t||this)},this):_.each(_.isArray(t)?t:[t],function(t){var n=b.call(this,e,t,i||this);"DOM"!==n.type||this._eventsDelegated?this._addEvent(n):(this._eventsToDelegate||(this._eventsToDelegate=[]),this._eventsToDelegate.push(n))},this),this)},delegateEvents:function(e){this.undelegateEvents(),e&&(_.isFunction(e)&&(e=e.call(this)),this._eventsToDelegate=[],this.on(e)),this._eventsToDelegate&&_.each(this._eventsToDelegate,this._addEvent,this),this._eventsDelegated=!0},_addEvent:function(e){if(e.handler._thoraxBind)return ut.call(this,e.name,e.handler,e.context||this);var t=w.call(this,e.type+"-event:",e);if("view"===e.type)e.context&&e.context!==this&&e.context instanceof lt.View?d(e.context,this,e.name,t,e.context):ut.call(this,e.name,t,e.context||this);else{e.nested||(t=y(t,this.cid));var i=e.name+".delegateEvents"+this.cid;e.selector?this.$el.on(i,e.selector,t):this.$el.on(i,t)}}}),lt.View.prototype.bind=lt.View.prototype.on,lt.View.on("ready",function(e){function t(t){t._isReady||t.trigger("ready",e)}this._isReady||(this._isReady=!0,_.each(this.children,t),this.on("child",t))});var dt,pt=/^(nested\s+)?(\S+)(?:\s+(.+))?/,ft=[];v(["mousedown","mouseup","mousemove","mouseover","mouseout","touchstart","touchend","touchmove","click","dblclick","keyup","keydown","keypress","submit","change","input","focus","blur"]);var mt="data-view-tmp",gt={},_t={_ensureElement:function(){lt.View.prototype._ensureElement.apply(this,arguments),this.$el.attr(st,this._helperName)},_getContext:function(){return this.parent._getContext.apply(this.parent,arguments)}};lt.HelperView=lt.View.extend(_t),Handlebars.registerViewHelper=function(e,t,i){2===arguments.length&&(t.factory?i=t.callback:(i=t,t=lt.HelperView));var n=t.attributeWhiteList;Handlebars.registerHelper(e,function(){var r=_.toArray(arguments),o=r.pop(),s=f(o).view,a=o.hash["expand-tokens"];a&&(delete o.hash["expand-tokens"],_.each(o.hash,function(e,t){o.hash[t]=lt.Util.expandToken(e,this)},this));var l={inverse:o.inverse,options:o.hash,declaringView:s,parent:C(s),_helperName:e,_helperOptions:{options:x(o),args:_.clone(r)}};m(o.hash);var c=_.clone(o.hash);n&&_.each(n,function(e,t){delete c[t],_.isUndefined(o.hash[t])||(l[e]=o.hash[t])}),c.tagName&&(l.tagName=c.tagName),l.attributes=function(){var e=t.prototype&&t.prototype.attributes||{};return _.isFunction(e)&&(e=e.apply(this,arguments)),_.extend(e,_.omit(c,["tagName"])),e.className&&(e["class"]=e.className,delete e.className),e},o.fn?l.template=o.fn:t&&t.prototype&&!t.prototype.template&&(l.template=Handlebars.VM.noop);var h=_.find(s._previousHelpers,function(e){return V(l,e)});if(h){if(!h.el)throw new Error("insert-destroyed");s._previousHelpers=_.without(s._previousHelpers,h),s.children[h.cid]=h}else{if(t.factory){if(h=t.factory(r,l),!h)return"";h._helperName=l._helperName,h._helperOptions=l._helperOptions}else h=new t(l);if(!h.el)throw new Error("insert-destroyed-factory");s._previousHelpers=_.without(s._previousHelpers,h),r.push(h),s._addChild(h),s.trigger.apply(s,["helper",e].concat(r)),s.trigger.apply(s,["helper:"+e].concat(r)),i&&i.apply(this,r)}return c[mt]=h.cid,t.modifyHTMLAttributes&&t.modifyHTMLAttributes(c,h),new Handlebars.SafeString(lt.Util.tag(c,"",a?this:null))});var r=Handlebars.helpers[e];return r},lt.View.on("append",function(e,t){(e||this.$el).find("["+mt+"]").forEach(function(e){var i=e.getAttribute(mt),n=this.children[i];n&&(gt[i]?(n.render(gt[i]),delete gt[i]):n.ensureRendered(),$(e).replaceWith(n.el),t&&t(n.el))},this)}),_.extend(lt.View.prototype,{getObjectOptions:function(e){return e&&this._objectOptionsByCid[e.cid]},bindDataObject:function(e,t,i){if(this._boundDataObjectsByCid[t.cid])return!1;this._boundDataObjectsByCid[t.cid]=t;var i=this._modifyDataObjectOptions(t,_.extend({},ht[e].defaultOptions,i));this._objectOptionsByCid[t.cid]=i,H.call(this,e,t,this.constructor),H.call(this,e,t,this);var n=ht[e];return n.bindCallback&&n.bindCallback.call(this,t,i),t.shouldFetch&&t.shouldFetch(i)?E(t,i):ht[e].change&&ht[e].change.call(this,t,i),!0},unbindDataObject:function(e){return this._boundDataObjectsByCid[e.cid]?(delete this._boundDataObjectsByCid[e.cid],this.stopListening(e),delete this._objectOptionsByCid[e.cid],!0):!1},_modifyDataObjectOptions:function(e,t){return t}});var vt="data-model-cid";lt.Model=Backbone.Model.extend({isEmpty:function(){return!this.isPopulated()},isPopulated:function(){var e=_.clone(this.attributes),t=a(this,"defaults")||{};for(var i in t){if(e[i]!=t[i])return!0;delete e[i]}var n=_.keys(e);return n.length>1||1===n.length&&n[0]!==this.idAttribute},shouldFetch:function(e){var t;try{t=a(this,"url")}catch(i){t=!1}return e.fetch&&!!t&&!this.isPopulated()}}),lt.Models={},n(lt.Model,lt.Models),T("model",{set:"setModel",defaultOptions:{render:void 0,fetch:!0,success:!1,invalid:!0},change:k,$el:"$el",cidAttrName:vt}),lt.View.on({model:{invalid:function(e,t){this.getObjectOptions(e).invalid&&this.trigger("invalid",t,e)},error:function(e,t){this.trigger("error",t,e)},change:function(e,t){ht.model.change.call(this,e,t)}}}),$.fn.model=function(e){var t=$(this),i=t.closest("["+vt+"]"),n=i&&i.attr(vt);if(n){var e=e||t.view();if(e&&e.model&&e.model.cid===n)return e.model||!1;var r=t.collection(e);if(r)return r.get(n)}return!1};var yt=Backbone.Collection.prototype.fetch,wt=Backbone.Collection.prototype.set,bt=lt.View.prototype._replaceHTML,Ct="data-collection-cid",xt="data-collection-empty",Vt="data-collection-element",Tt=1;lt.Collection=Backbone.Collection.extend({model:lt.Model||Backbone.Model,initialize:function(){return this.cid=_.uniqueId("collection"),Backbone.Collection.prototype.initialize.apply(this,arguments)},isEmpty:function(){return this.length>0?!1:0===this.length&&this.isPopulated()},isPopulated:function(){return this._fetched||this.length>0||!this.length&&!a(this,"url")},shouldFetch:function(e){return e.fetch&&!!a(this,"url")&&!this.isPopulated()},fetch:function(e){e=e||{};var t=e.success;return e.success=function(e,i){e._fetched=!0,t&&t(e,i)},yt.apply(this,arguments)},set:function(e,t){return this._fetched=!!e,wt.call(this,e,t)}}),_.extend(lt.View.prototype,{getCollectionViews:function(e){return _.filter(this.children,function(t){return t instanceof lt.CollectionView?!e||t.collection===e:!1})},updateFilter:function(e){_.invoke(this.getCollectionViews(e),"updateFilter")}}),lt.Collections={},n(lt.Collection,lt.Collections),T("collection",{set:"setCollection",bindCallback:L,defaultOptions:{render:void 0,fetch:!0,success:!1,invalid:!0,change:!0},change:F,$el:"getCollectionElement",cidAttrName:Ct}),lt.CollectionView=lt.View.extend({_defaultTemplate:Handlebars.VM.noop,_collectionSelector:"["+Vt+"]",_replaceHTML:function(e){if(!(this.collection&&this.getObjectOptions(this.collection)&&this._renderCount))return bt.call(this,e);var t,i=this.getCollectionElement();t=bt.call(this,e),i.attr("data-view-cid")||this.getCollectionElement().replaceWith(i)},render:function(){var e=this.shouldRender();lt.View.prototype.render.apply(this,arguments),e||this.renderCollection()},appendItem:function(e,t,i){if(e){var n,r=this.getCollectionElement(),o=this.collection;if(i=_.defaults(i||{},{filter:!0}),t&&t.el&&(t=r.children().indexOf(t.el)+1),e.el||_.isString(e)?(n=e,e=!1):(t=t||o.indexOf(e)||0,n=this.renderItem.call(this,e,t)),n){n.cid&&(n.ensureRendered(),this._addChild(n)),_.isString(n)&&!n.match(/^\s*</m)&&(n="<div>"+n+"</div>");var s=n.$el||$($.trim(n)).filter(function(){return this.nodeType===Tt});e&&s.attr(vt,e.cid);var a=t>0?o.at(t-1):!1;if(a){var l=r.children("["+vt+'="'+a.cid+'"]').last();l.after(s)}else r.prepend(s);this.trigger("append",null,function(t){t.setAttribute(vt,e.cid)}),i.silent||this.trigger("rendered:item",this,o,e,s,t),i.filter&&N.call(this,e)}return n}},updateItem:function(e){var t=this.getCollectionElement(),i=t.find("["+vt+'="'+e.cid+'"]');i.attr(ot)||(this.removeItem(i),this.appendItem(e))},removeItem:function(e){var t=e;if(e.cid){var i=this.getCollectionElement();t=i.find("["+vt+'="'+e.cid+'"]')}if(!t.length)return!1;var n=t.find("["+ot+"]").map(function(e,t){return $(t).attr(ot)});return t.remove(),n.push(t.attr(ot)),_.each(n,function(e){var t=this.children[e];t&&this._removeChild(t)},this),!0},renderCollection:function(){this.collection?(this.collection.isEmpty()?B.call(this):(D.call(this),this.collection.forEach(function(e,t){this.appendItem(e,t)},this)),this.trigger("rendered:collection",this,this.collection)):B.call(this)},emptyClass:"empty",renderEmpty:function(){if(this.emptyView||o.call(this,"emptyView",{extension:"-empty"}),this.emptyTemplate||this.emptyView||s.call(this,"emptyTemplate",{extension:"-empty",required:!1}),this.emptyView){var e={};this.emptyTemplate&&(e.template=this.emptyTemplate);var t=lt.Util.getViewInstance(this.emptyView,e);return t.ensureRendered(),t}return this.emptyTemplate&&this.renderTemplate(this.emptyTemplate)},renderItem:function(e,t){if(this.itemView||o.call(this,"itemView",{extension:"-item",required:!1}),this.itemTemplate||this.itemView||s.call(this,"itemTemplate",{extension:"-item",required:!this.itemView}),this.itemView){var i={model:e};return this.itemTemplate&&(i.template=this.itemTemplate),lt.Util.getViewInstance(this.itemView,i)}return this.renderTemplate(this.itemTemplate,this.itemContext.call(this,e,t))},itemContext:function(e){return e.attributes},appendEmpty:function(){var e=this.getCollectionElement();e.empty();var t=this.renderEmpty.call(this);t&&this.appendItem(t,0,{silent:!0,filter:!1}),this.trigger("rendered:empty",this,this.collection)},getCollectionElement:function(){var e=this.$(this._collectionSelector);return 0===e.length?this.$el:e},updateFilter:function(){j.call(this)}}),lt.CollectionView.on({collection:{reset:F,sort:F,change:function(e){var t=this.getObjectOptions(this.collection);t&&t.change&&this.updateItem(e),N.call(this,e)},add:function(e){var t=this.getCollectionElement();if(t.length){1===this.collection.length&&D.call(this);var i=this.collection.indexOf(e);this.appendItem(e,i)}},remove:function(e){var t=this.getCollectionElement();this.removeItem(e),0===this.collection.length&&t.length&&B.call(this)}}}),lt.View.on({collection:{invalid:function(e,t){this.getObjectOptions(e).invalid&&this.trigger("invalid",t,e)},error:function(e,t){this.trigger("error",t,e)}}}),$.fn.collection=function(e){if(e&&e.collection)return e.collection;var t=$(this),i=t.closest("["+Ct+"]"),n=i&&i.attr(Ct);return n&&(e=t.view())?e.collection:!1},ht.model.defaultOptions.populate=!0;var Ht=ht.model.change;ht.model.change=function(e,t){if(this._isChanging=!0,Ht.apply(this,arguments),this._isChanging=!1,!t||!t.serializing){var i=q(this);this._renderCount&&i&&this.populate(!i.context&&this.model.attributes,i)}},_.extend(lt.View.prototype,{serialize:function(){for(var e,t,i,n=0;n<arguments.length;++n)_.isFunction(arguments[n])?e=arguments[n]:_.isObject(arguments[n])&&("stopPropagation"in arguments[n]&&"preventDefault"in arguments[n]?i=arguments[n]:t=arguments[n]);if(!i||this._preventDuplicateSubmission(i)){t=_.extend({set:!0,validate:!0,children:!0},t||{});var r=t.attributes||{},o=this,s=[];if(I(this,t,function(e){var i=o._getInputValue(e,t,s);_.isUndefined(i)||A(r,e.name,{mode:"serialize"},function(e,t){e[t]?_.isArray(e[t])?e[t].push(i):e[t]=[e[t],i]:e[t]=i})}),t._silent||this.trigger("serialize",r,t),t.validate){var a=this.validateInput(r);if(a&&a.length&&(s=s.concat(a)),this.trigger("validate",r,s,t),s.length)return void this.trigger("invalid",s)}return t.set&&this.model&&!this.model.set(r,{silent:t.silent,serializing:!0})?!1:(e&&e.call(this,r,_.bind(R,this)),r)}},_preventDuplicateSubmission:function(e,t){e.preventDefault();var i=$(e.target);return"form"!==(e.target.tagName||"").toLowerCase()&&(i=$(e.target).closest("form")),i.attr("data-submit-wait")?!1:(i.attr("data-submit-wait","true"),t&&t.call(this,e),!0)},populate:function(e,t){t=_.extend({children:!0},t||{});var i,e=e||this._getContext();I(this,t,function(t){A(e,t.name,{mode:"populate"},function(e,n){if(i=e&&e[n],!_.isUndefined(i)){var r="checkbox"===t.type||"radio"===t.type;r&&_.isBoolean(i)?t.checked=i:r?t.checked=i==t.value:t.value=i}})}),++this._populateCount,t._silent||this.trigger("populate",e)},validateInput:function(){},_getInputValue:function(e){if("checkbox"!==e.type&&"radio"!==e.type){if(e.multiple===!0){var t=[];return $("option",e).each(function(){this.selected&&t.push(this.value)}),t}return e.value}return e.checked?e.getAttribute("value")||!0:void 0},_populateCount:0}),lt.View.on({"before:rendered":function(){if(this._renderCount&&(this.model&&this.model.cid)===this._formModelCid){var e=this.getObjectOptions(this.model);this.previousFormData=U(this.serialize(_.extend({set:!1,validate:!1,_silent:!0},e)),function(e){return""!==e&&null!=e})}},rendered:function(){var e=q(this);!e||this._isChanging||this._populateCount||this.populate(!e.context&&this.model.attributes,e),this.previousFormData&&this.populate(this.previousFormData,_.extend({_silent:!0},e)),this._formModelCid=this.model&&this.model.cid,this.previousFormData=null}}),lt.View.on({invalid:M,error:M,deactivated:function(){this.$el&&R.call(this)}});var Et="data-layout-cid";lt.LayoutView=lt.View.extend({_defaultTemplate:Handlebars.VM.noop,render:function(){var e=lt.View.prototype.render.apply(this,arguments);return this.template===Handlebars.VM.noop?Q.call(this):z.call(this),e},setView:function(e,t){t=_.extend({scroll:!0},t||{}),_.isString(e)&&(e=new(lt.Util.registryGet(lt,"Views",e,!1))),this.ensureRendered();var i,n,r,o=this._view;return e===o?!1:(this.trigger("change:view:start",e,o,t),n=_.bind(function(){o&&(o.$el&&o.$el.remove(),P.call(o,"deactivated",t),this._removeChild(o))},this),i=_.bind(function(){if(e){e.ensureRendered(),P.call(this,"activated",t),e.trigger("activated",t),this._view=e;var i=W.call(this);this._view.appendTo(i),this._addChild(e)}else this._view=void 0},this),r=_.bind(function(){this.trigger("change:view:end",e,o,t)},this),t.transition?t.transition(e,o,i,n,r):(n(),i(),r()),e)},getView:function(){return this._view}}),Handlebars.registerHelper("layout-element",function(e){var t=f(e).view;if(!t.getView)throw new Error(i("layout-element-helper"));return e.hash[Et]=t.cid,m(e.hash),new Handlebars.SafeString(lt.Util.tag.call(this,e.hash,"",this))}),lt.CollectionHelperView=lt.CollectionView.extend({events:{"rendered:item":G("rendered:item"),"rendered:collection":G("rendered:collection"),"rendered:empty":G("rendered:empty")},getCollectionElement:function(){return this.$el},constructor:function(e){e.options["item-template"]&&(e.itemTemplate=lt.Util.getTemplate(e.options["item-template"])),e.options["empty-template"]&&(e.emptyTemplate=lt.Util.getTemplate(e.options["empty-template"])),!e.itemTemplate&&e.template&&e.template!==Handlebars.VM.noop&&(e.itemTemplate=e.template,e.template=Handlebars.VM.noop),!e.emptyTemplate&&e.inverse&&e.inverse!==Handlebars.VM.noop&&(e.emptyTemplate=e.inverse,e.inverse=Handlebars.VM.noop);var t=_.isFunction(e.itemContext),i=_.isFunction(e.itemFilter),n=lt.HelperView.call(this,e);return t?this.itemContext=_.bind(this.itemContext,this.parent):_.isString(this.itemContext)&&(this.itemContext=_.bind(this.parent[this.itemContext],this.parent)),i?this.itemFilter=_.bind(this.itemFilter,this.parent):_.isString(this.itemFilter)&&(this.itemFilter=_.bind(this.parent[this.itemFilter],this.parent)),this.parent.name&&(this.emptyView||this.parent.renderEmpty||(this.emptyView=lt.Util.getViewClass(this.parent.name+"-empty",!0)),this.emptyTemplate||this.parent.renderEmpty||(this.emptyTemplate=lt.Util.getTemplate(this.parent.name+"-empty",!0)),this.itemView||this.parent.renderItem||(this.itemView=lt.Util.getViewClass(this.parent.name+"-item",!0)),this.itemTemplate||this.parent.renderItem||(this.itemTemplate=lt.Util.getTemplate(this.parent.name+"-item",!!this.itemView))),n},setAsPrimaryCollectionHelper:function(){_.each(Ot,function(e){J.call(this,e)},this);var e=this;_.each(["itemFilter","itemContext","renderItem","renderEmpty"],function(t){e.parent[t]&&(e[t]=function(){return e.parent[t].apply(e.parent,arguments)})})}}),_.extend(lt.CollectionHelperView.prototype,_t),lt.CollectionHelperView.attributeWhiteList={"item-context":"itemContext","item-filter":"itemFilter","item-template":"itemTemplate","empty-template":"emptyTemplate","item-view":"itemView","empty-view":"emptyView","empty-class":"emptyClass"};var Ot=["itemTemplate","itemView","emptyTemplate","emptyView"];Handlebars.registerViewHelper("collection",lt.CollectionHelperView,function(e,t){1===arguments.length&&(t=e,e=t.parent.collection,e&&t.setAsPrimaryCollectionHelper(),t.$el.attr(Vt,"true"),t.listenTo(t.parent,"change:data-object",function(e,i){"collection"===e&&(t.setAsPrimaryCollectionHelper(),t.setCollection(i))
})),e&&t.setCollection(e)}),Handlebars.registerHelper("collection-element",function(e){if(!f(e).view.renderCollection)throw new Error(i("collection-element-helper"));var t=e.hash;return m(t),t.tagName=t.tagName||"div",t[Vt]=!0,new Handlebars.SafeString(lt.Util.tag.call(this,t,"",this))}),Handlebars.registerHelper("empty",function(e,t){1===arguments.length&&(t=e);var i=f(t).view;return 1===arguments.length&&(e=i.model),i._emptyListeners||(i._emptyListeners={}),e&&!i._emptyListeners[e.cid]&&e.models&&"length"in e&&(i._emptyListeners[e.cid]=!0,i.listenTo(e,"remove",function(){0===e.length&&i.render()}),i.listenTo(e,"add",function(){1===e.length&&i.render()}),i.listenTo(e,"reset",function(){i.render()})),!e||e.isEmpty()?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("template",function(e,t){var i=_.extend({fn:t&&t.fn},this,t?t.hash:{}),n=f(t).view.renderTemplate(e,i);return new Handlebars.SafeString(n)}),Handlebars.registerHelper("yield",function(e){return f(e)["yield"]&&e.data["yield"]()}),Handlebars.registerHelper("url",function(e){e=e||"";var t;if(arguments.length>2)t=_.map(_.head(arguments,arguments.length-1),encodeURIComponent).join("/");else{var i=arguments[1],n=i&&i.hash||i;t=n&&n["expand-tokens"]?lt.Util.expandToken(e,this,!0):e}if(Backbone.history._hasPushState){var r=Backbone.history.options.root;return"/"===r&&"/"===t.substr(0,1)?t:r+t}return"#"+t}),Handlebars.registerViewHelper("view",{factory:function(e,t){var i=e.length>=1?e[0]:lt.View;return lt.Util.getViewInstance(i,t.options)},modifyHTMLAttributes:function(e,t){e.tagName=t.el.tagName.toLowerCase()},callback:function(e){var t=arguments[arguments.length-1],n=t._helperOptions.options,r=t.cid;if(!_.isString(e)&&n.hash&&_.keys(n.hash).length>0)throw new Error(i("view-helper-hash-args"));n.fn&&(gt[r]=n.fn)}});var kt="data-call-method",$t="data-trigger-event";Handlebars.registerHelper("button",function(e,t){1===arguments.length&&(t=e,e=t.hash.method);var n=t.hash,r=n["expand-tokens"];if(delete n["expand-tokens"],!e&&!t.hash.trigger)throw new Error(i("button-trigger"));return m(n),n.tagName=n.tagName||"button",n.trigger&&(n[$t]=n.trigger),delete n.trigger,e&&(n[kt]=e),new Handlebars.SafeString(lt.Util.tag(n,t.fn?t.fn(this):"",r?this:null))}),Handlebars.registerHelper("link",function(){var e=_.toArray(arguments),t=e.pop(),n=t.hash,r=0===e.length?[n.href]:e,o=n["expand-tokens"];if(delete n["expand-tokens"],!r[0]&&""!==r[0])throw new Error(i("link-href"));return m(n),r.push(t),n.href=Handlebars.helpers.url.apply(this,r),n.tagName=n.tagName||"a",n.trigger&&(n[$t]=t.hash.trigger),delete n.trigger,n[kt]="_anchorClick",new Handlebars.SafeString(lt.Util.tag(n,t.fn?t.fn(this):"",o?this:null))});var Ft,Lt="["+kt+"], ["+$t+"]";$(document).ready(function(){lt._fastClickEventName||X()});var jt="data-element-tmp";Handlebars.registerHelper("element",function(e,t){m(t.hash);var i=_.uniqueId("element"),n=f(t).view;return t.hash[jt]=i,n._elementsByCid||(n._elementsByCid={}),n._elementsByCid[i]=e,new Handlebars.SafeString(lt.Util.tag(t.hash))}),lt.View.on("append",function(e,t){(e||this.$el).find("["+jt+"]").forEach(function(e){var i=$(e),n=i.attr(jt),r=this._elementsByCid[n];_.isFunction(r)&&(r=r.call(this)),i.replaceWith(r),t&&t(r)},this)}),Handlebars.registerHelper("super",function(e){var t=f(e).view,n=t.constructor&&t.constructor.__super__;if(n){var r=n.template;if(!r){if(!n.name)throw new Error(i("super-parent"));r=n.name}return _.isString(r)&&(r=lt.Util.getTemplate(r,!1)),new Handlebars.SafeString(r(this,e))}return""});var Nt,St="load:start",Dt="load:end";lt.setRootObject=function(e){Nt=e},lt.loadHandler=function(e,t,i){var n=_.uniqueId("load");return function(r,o,s){function a(){if(!c.timeout||c.run){var t=void 0!==l._loadingTimeoutDuration?l._loadingTimeoutDuration:lt.View.prototype._loadingTimeoutDuration;c.timeout=setTimeout(lt.bindSection("load-start",function(){c.events.length&&(c.run=!0,e.call(l,c.message,c.background,c))}),1e3*t)}}var l=i||this;l._loadInfo=l._loadInfo||{};var c=l._loadInfo[n];c?(clearTimeout(c.endTimeout),c.message=r,!o&&c.background&&(c.background=!1,a())):(c=l._loadInfo[n]=_.extend({isLoading:function(){return c.events.length},cid:n,events:[],timeout:0,message:r,background:!!o},Backbone.Events),a()),_.indexOf(c.events,s)>=0||(c.events.push(s),s.on(Dt,function h(){var e=l._loadingTimeoutEndDuration;void 0===e&&(e=lt.View.prototype._loadingTimeoutEndDuration);var i=c.events,r=_.indexOf(i,s);r>=0&&!s.isLoading()&&(i.splice(r,1),_.indexOf(i,s)<0&&s.off(Dt,h)),i.length||(clearTimeout(c.endTimeout),c.endTimeout=setTimeout(lt.bindSection("load-end",function(){i.length||(c.run&&(t&&t.call(l,c.background,c),c.trigger(Dt,c)),clearTimeout(c.timeout),c=l._loadInfo[n]=void 0)}),1e3*e))}))}},lt.forwardLoadEvents=function(e,t,i){function n(r,o,s){i&&e.off(St,n),t.trigger(St,r,o,s)}return e.on(St,n),{off:function(){e.off(St,n)}}},lt.mixinLoadable=function(e,t){_.extend(e,{_loadingClassName:"loading",_loadingTimeoutDuration:.33,_loadingTimeoutEndDuration:.1,onLoadStart:function(e,i,n){var r=t?this.parent:this;r&&r.el&&(r.nonBlockingLoad||i||!Nt||Nt===this||Nt.trigger(St,e,i,n),r._isLoading=!0,$(r.el).addClass(r._loadingClassName),r.trigger("change:load-state","start",i))},onLoadEnd:function(){var e=t?this.parent:this;e&&e.el&&(e._isLoading=!1,$(e.el).removeClass(e._loadingClassName),e.trigger("change:load-state","end"))}})},lt.mixinLoadableEvents=function(e,t){_.extend(e,{_loadCount:0,isLoading:function(){return this._loadCount>0},loadStart:function(e,i){this._loadCount++;var n=t?this.parent:this;n.trigger(St,e,i,n)},loadEnd:function(){this._loadCount--;var e=t?this.parent:this;e.trigger(Dt,e)}})},lt.mixinLoadable(lt.View.prototype),lt.mixinLoadableEvents(lt.View.prototype),lt.HelperView&&(lt.mixinLoadable(lt.HelperView.prototype,!0),lt.mixinLoadableEvents(lt.HelperView.prototype,!0)),lt.CollectionHelperView&&(lt.mixinLoadable(lt.CollectionHelperView.prototype,!0),lt.mixinLoadableEvents(lt.CollectionHelperView.prototype,!0)),lt.sync=function(e,t,i){var n=this,r=i.complete;return i.complete=function(){n._request=void 0,n._aborted=!1,r&&r.apply(this,arguments)},this._request=Backbone.sync.apply(this,arguments),this._request};var Bt=[];lt.Model&&Bt.push(lt.Model),lt.Collection&&Bt.push(lt.Collection),_.each(Bt,function(e){var t=e.prototype.fetch;lt.mixinLoadableEvents(e.prototype,!1),_.extend(e.prototype,{sync:lt.sync,fetch:function(i){function n(e){var t=i[e];i[e]=function(){r.loadEnd(),t&&t.apply(this,arguments)}}if(i=i||{},e===lt.Collection&&(_.find(["reset","remove","add","update"],function(e){return!_.isUndefined(i[e])})||(i.reset=!0)),!i.loadTriggered){var r=this;n("success"),n("error"),r.loadStart(void 0,i.background)}return tt.call(this,i||{},t)},load:function(e,t,i){2!==arguments.length||_.isFunction(t)||(i=t,t=!1),i=i||{},i.background||this.isPopulated()||!Nt||(this.isLoading()?Nt.trigger(St,i.message,i.background,this):lt.forwardLoadEvents(this,Nt,!0)),et.call(this,e,t,i)}})}),lt.Util.bindToRoute=Z,lt.View.prototype._modifyDataObjectOptions=function(e,t){return t.ignoreErrors=this.ignoreFetchError,t.background=this.nonBlockingLoad,t},lt.HelperView.prototype._modifyDataObjectOptions=lt.CollectionHelperView.prototype._modifyDataObjectOptions=function(e,t){return t.ignoreErrors=this.parent.ignoreFetchError,t.background=this.parent.nonBlockingLoad,t},ht.collection.loading=function(){var e=this.loadingView,t=this.loadingTemplate,i=this.loadingPlacement;if(e||t){var n=lt.loadHandler(_.bind(function(){var n;if(0===this.collection.length&&this.$el.empty(),e){var r=lt.Util.getViewInstance(e);this._addChild(r),t?r.render(t):r.render(),n=r}else n=this.renderTemplate(t);var o=i?i.call(this):this.collection.length;this.appendItem(n,o),this.$el.children().eq(o).attr("data-loading-element",this.collection.cid)},this),_.bind(function(){this.$el.find('[data-loading-element="'+this.collection.cid+'"]').remove()},this),this.collection);this.listenTo(this.collection,"load:start",n)}},lt.CollectionHelperView&&_.extend(lt.CollectionHelperView.attributeWhiteList,{"loading-template":"loadingTemplate","loading-view":"loadingView","loading-placement":"loadingPlacement"}),lt.View.on({"load:start":lt.loadHandler(function(e,t,i){this.onLoadStart(e,t,i)},function(e,t){this.onLoadEnd(t)}),collection:{"load:start":function(e,t,i){this.trigger(St,e,t,i)}},model:{"load:start":function(e,t,i){this.trigger(St,e,t,i)}}}),Handlebars.registerHelper("loading",function(e){var t=f(e).view;return t.off("change:load-state",nt,t),t.on("change:load-state",nt,t),t._isLoading?e.fn(this):e.inverse(this)});var Ut=/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),Mt=!!navigator.userAgent.match(/Trident\/7\./);Ut&&lt.View.on("before:append",function(){this._renderCount>0&&(_.each(this._elementsByCid,function(e){$(e).detach()}),_.each(this.children,function(e){e.$el.detach()}))}),(Ut||Mt)&&(lt.CollectionView.prototype._replaceHTML=function(e){if(!this.getObjectOptions(this.collection)||!this._renderCount)return bt.call(this,e);var t,i=this.getCollectionElement().clone(!0,!0);t=bt.call(this,e),i.attr("data-view-cid")||this.getCollectionElement().replaceWith(i)},lt.View.prototype._replaceHTML=function(e){for(;this.el.hasChildNodes();)this.el.removeChild(this.el.childNodes[0]);return this.$el.append(e)})}();