!function(e){"object"==typeof exports?module.exports=e(require("lodash"),require("handlebars.phrase"),require("handlebars.el")):"function"==typeof define&&define.amd&&define(["lodash","handlebars.phrase","handlebars.el"],e)}(function(e,t,l){var a=function(l){function a(){var e=Array.prototype.slice.call(arguments),t=e[e.length-1].hash;if(t["el-tag"]="input",t.type=e.shift(),t["el-control"]===!1){for(var a in t.attributes)void 0===t[a]&&(t[a]=t.attributes[a]);if(delete t.attributes,t["el-tag"]="p",void 0===t.content){if("checkbox"===t.type){var r=!!t.checked;t.content=r.toString()}else t.contents=t.value;delete t.value,delete t.id,delete t.name,delete t.type}}delete t["el-control"];var n=l.helpers.el.apply(this,e);return n}function r(t){if(void 0!==t&&null!==t){e.isArray(t)||(t=[t]);for(var l=0;l<t.length;l++)t[l]=t[l].toString()}return t}function n(e){return"<legend><span>"+e+"</span></legend>"}function i(e,t){void 0===t[e]?t[e]={}:"string"==typeof t[e]&&(t[e]={content:t[e]});var l=t[e];for(var a in t)if(0===a.indexOf(e+"-")){var r=a.split(e+"-")[1];l[r]=t[a],delete t[a]}return t}var s={edit:"edit",display:"display"},o={},p={"el-tag":"form",method:"post","el-escape":!1};o["el-form"]=function(){var t=Array.prototype.slice.call(arguments),a=t.pop(),r=a.hash,n=r.model;delete r.model;var i=r.wizard;delete r.wizard,r=e.extend({},r.attributes,r),delete r.attributes,r=e.extend({},p,r),a.hash=r;var s=this||{};return s.model=n,s.wizardSchema=i,l.helpers.el.apply(s,[a])},o["el-text"]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("text"),a.apply(this,e)},o["el-checkbox"]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("checkbox"),e[e.length-1].hash["el-fallback-value"]=!0,a.apply(this,e)},o["el-radio"]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("radio"),a.apply(this,e)},o["el-password"]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("password"),a.apply(this,e)},o["el-file"]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("file"),a.apply(this,e)},o["el-hidden"]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("hidden"),a.apply(this,e)},o["el-submit"]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("submit"),a.apply(this,e)},o["el-select"]=function(){var t=Array.prototype.slice.call(arguments),a=t[t.length-1],n=a.hash;n=e.extend({},n.attributes,n),delete n.attributes,a.hash=n;var i="",s=n.selected,o=n.value,p=n["options-disabled"],d=n.cue,c=n.options,h=n.values;c||(c=h),delete n.selected,delete n.value,delete n["options-disabled"],delete n.cue,delete n.options,delete n.values,void 0===s&&(s=o),s=r(s),p=r(p);var u;for(var v in c){var f=c[v];"object"!=typeof f&&(f={content:f}),h&&void 0!==h[v]?f.value=h[v]:void 0===f.value&&(f.value=f.content),f.value=f.value.toString(),void 0!==s&&(f.selected=e.intersection(s,[f.value]).length>0,u||(u=f.selected)),p&&(f.disabled=e.intersection(p,[f.value]).length>0),c[v]=f}!u&&d&&("object"!=typeof d&&(d={content:d,"class":"select-cue",selected:!0,disabled:!0}),c.unshift(d));for(var y in c)c[y]["el-tag"]="option",i+=l.helpers.el.apply(this,[{hash:c[y]}]);return n["el-tag"]="select",n.content=i,n["el-escape"]=!1,i=l.helpers.el.apply(this,t)},o["el-textarea"]=function(){var a=Array.prototype.slice.call(arguments),r=a[a.length-1].hash;r["el-control"]===!1?(r=e.extend({},r.attributes,r),delete r.attributes,r["el-tag"]="p",r.content=r.value,delete r.value,delete r.name,delete r.placeholder,a[a.length-1].hash=r):(r=e.extend({},r.attributes,r),delete r.attributes,r["el-content"]||(r["el-content"]=r.value,delete r.value),r["el-tag"]="textarea",!r.placeholder&&r["el-phrase-key"]&&(r.placeholder=t.get(r["el-phrase-key"]+".placeholder")),a[a.length-1].hash=r);var n=l.helpers.el.apply(this,a);return n},o["el-label"]=function(){var e=Array.prototype.slice.call(arguments),t=e[e.length-1].hash;t["el-tag"]="label",void 0!==t.edit&&t.edit===!1&&(t["el-tag"]="h3",delete t["for"]),delete t.edit;var a=l.helpers.el.apply(this,e);return a},o["el-fieldset"]=function(){var e=Array.prototype.slice.call(arguments),t=e[e.length-1].hash;t["el-tag"]="fieldset",t["el-escape"]=!1,t.legend&&(t["el-content-before"]=n(t.legend),delete t.legend);var a=l.helpers.el.apply(this,e);return a},o["el-message"]=function(){var a=Array.prototype.slice.call(arguments),r=a.shift(),n=a.shift(),i=a.shift();e.isArray(i)||(i=[i]);var s={content:i,"el-wrap":"li","el-tag":"ul"},o=l.helpers.el({hash:s}),p=t.get("field.message.heading."+n,{field:r,count:i.length});p&&(o="<h2>"+p+"</h2>"+o);var d={"el-tag":"div","class":"control-"+n,content:o,"el-escape":!1},c=l.helpers.el({hash:d});return c},o["el-field"]=function(){function a(e){var t=f[e];return delete f[e],t}function n(e){var t=f[e];return delete f[e],void 0===t&&(t=g[e]),delete g[e],t}var o={},p=["legend","introduction","label","description","help","error","warning","info","extra"],d=["introduction","label","description","help","main","error","warning","info","extra"],c=["label","main"],h={error:!0,warning:!0,info:!0},u=Array.prototype.slice.call(arguments),v=u[u.length-1],f=v.hash;f=e.extend({},f.attributes,f),delete f.attributes;var y;f=i("input",f),f=i("help",f),f=i("error",f),f=i("label",f),f=i("field",f);var g=a("field"),b=n("input"),m=n("inputs"),x=n("labels"),A=n("checked"),k=n("inputs-disabled"),w=n("phrase-key"),C=n("model")||this.model,S=n("edit"),j=n("display"),E=void 0===this.edit||this.edit;void 0===j&&(j=!E),void 0===S&&(S=!j);var H=S?"edit":"display";g.type&&(f.type=f.type||g.type,delete g.type),f.type&&(y=f.type,delete f.type),f.name&&(b.name=f.name,delete f.name);var K=m||x?!0:!1;if(C&&b.name){var q=b.name;if(!w&&C.phraseKey){var z="function"==typeof C.phraseKey?C.phraseKey():C.phraseKey;w=z+"."+q}if(C.schema){var O,U=C.schema,B=U.properties[q];"array"===B.type&&(O=!0,B=B.items);var D;if(B["enum"]){D=e.extend([],B["enum"]);var F=[];for(var G in D){var I=D[G],J=t.get(w+".value."+I+".label");J=J?J.toString():I,F.push(J)}"text"===y&&(y=O?"checkbox":"radio"),"select"===y?e.isEmpty(b.options)&&e.isEmpty(f.options)&&(b.options=F,b.values=D):(K=!0,e.isEmpty(m)&&(m=D,x=F))}}var L=C.get(q);void 0!==L&&(K?void 0===A&&(A=L):void 0===b.value&&"checkbox"!==y&&(b.value=L)),"checkbox"===y&&(void 0===b.value&&(b.value=!0),void 0===b.checked&&L===b.value&&(b.checked=!0)),"password"===y&&b.value&&(b.placeholder=b.value.replace(/./g,"*"),S?delete b.value:b.value=b.placeholder)}for(var M in p){var N=p[M],P=n(N);w&&(void 0!==P&&(!e.isObject(P)||e.isArray(P)||"content"in P)||(P=t.get(w+"."+N,{display:j,edit:S}),P&&(P={content:P.toString()}))),e.isEmpty(P)||(o[N]=P)}var Q=o.label||{};delete o.label;var R=o.legend;delete o.legend;for(var T in o){var V=o[T];if(h[T])o[T]=l.helpers["el-message"](b.name,T,V);else{V["class"]="control-"+T,V.content.match(/^<(p|div|ul|ol)[ >]/)||(V["el-wrap"]="p");var W={hash:{attributes:V}};o[T]=l.helpers.el(W)}}if(f["class"]&&(g["class"]=f["class"],delete f["class"]),g["class"]||(g["class"]=[]),e.isArray(g["class"])||(g["class"]=[g["class"]]),g["class"].push("control"),b.name&&g["class"].push("control-"+b.name),void 0===g["el-escape"]&&(g["el-escape"]=!1),g.content="",v.fn)g.content=v.fn(this),delete v.fn;else if(f.id&&(b.id=f.id),b.id||(b.id="input-"+b.name),K){y=y||"radio";var X="";m||(m=x),A=r(A),k=r(k);var Y=b.name;for(var Z in m){var $=m[Z],_={};"object"!=typeof $&&($={value:$}),$.name=$.name||Y,$.id=$.id||$.name+"-"+Z,_.content=x&&void 0!==x[Z]?x[Z]:$.value,_["for"]=$.id,$.value=$.value.toString(),void 0!==A&&($.checked=e.intersection(A,[$.value]).length>0),k&&($.disabled=e.intersection(k,[$.value]).length>0),m[Z]=[$,_]}for(var et in m){var tt="",lt=m[et][0];lt["el-tag"]="input",tt+=l.helpers["el-"+y]({hash:lt});var at=m[et][1];at["el-tag"]="label",tt+=l.helpers.el({hash:at});var rt={hash:{"el-tag":"div","class":s[H],content:tt,"el-escape":!1}};X+=l.helpers.el(rt)}if(o.main=X,R){var nt=g.id||"control-group-"+b.name+"-label";g.role||(g.role="group",g["aria-labelledby"]=nt);var it={hash:{"el-tag":"p",content:R,id:nt}};R=l.helpers.el(it),o.label=R}}else{y=y||"text",Q["for"]||(Q["for"]=b.id),Q.content||(labelContent=b.name,labelContent&&(labelContent=labelContent.substr(0,1).toUpperCase()+labelContent.substr(1)),Q.content=labelContent),Q.edit=S;var st=l.helpers["el-label"]({hash:Q});o.label=st,f.attributes=b,f["el-wrap-outer"]={"el-tag":"div","class":s[H]},f["el-phrase-key"]=w,f["el-control"]=S,u[u.length-1].hash=f;var ot=l.helpers["el-"+y].apply(this,u);o.main=ot}var pt=S?d:c;for(var dt in pt)o[pt[dt]]&&(g.content+=o[pt[dt]]);void 0===g["el-tag"]&&(g["el-tag"]="div");var ct=l.helpers.el({hash:{attributes:g}});return ct};for(var d in o)l.registerHelper(d,o[d])};return{registerHelpers:function(e,r){e.helpers.phrase||t.registerHelper(e),e.helpers.el||l.registerHelper(e),a(e,r)}}});